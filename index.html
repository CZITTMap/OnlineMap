<!DOCTYPE html>
<html>

	<head>
		<title>My Interactive Map</title>
		
		<!-- this is what an HTML comment looks like -->
		 <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
			integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
			crossorigin=""/>
		 
		<!-- Make sure you put this AFTER Leaflet's CSS -->
		<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
			integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
			crossorigin="">
		</script>
		
		<link rel="stylesheet" href="style (2).css"/>
		
		<script src="leaflet-sidebar.js">
		</script>
		<link rel="stylesheet" href="leaflet-sidebar.css"/>
		
		
	</head>
	
	<body>
		<div id="mapid"></div>
		<script>
			let mapOptions = {
				center: [11.01, -61.1],
				zoom: 7,
			};
			const myMap = L.map("mapid", mapOptions);
			const Maptiles_A = L.tileLayer(
				'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
				{
				maxZoom: 19,
				attribution: '&copy; <a herf="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
			});
			
			Maptiles_A.addTo(myMap).setOpacity(0.5);
			
			//fetching the data 
			
			
			let treeLayer = L.geoJSON(null,
									{onEachFeature:
										function (feature, layer) {
										//layer.bindPopup("placeholder text blah blah blah")
										layer.bindPopup('
										<div class="tree-type">#${f.NUMBER}: ${f.TYPE}</div>
										<div class="timestamp">${f.PHOTO_TIMESTAMP}</div>
										<img class="photo" src="treeicon.png" alt="Photo of Tree">
										<div class="offset">Est.Offset: ${f.CARBONOFF_EST}</div>
										<div class="beneficiary">Beneficiary: ${f.BENEFICIARY}</div>
										<div class="planter">Planter: ${f.PLANTER}</div>
										<div class="risk-level">Risk: ${f.RISKLEVEL},/div>
										`)
									},
									
									pointToLayer: function(feature, latlng) {
										let iconOptions = {
										iconUrl: "treeicon.png",
										iconSize: [32, 32],
										iconAnchor: [16, 16],
										popupAnchor: [0, -8]
									};
									let treeIcon = L.icon(iconOptions);
									
									return L.marker(latlng, {icon: treeIcon})
									}
									});
			treeLayer.addTo(myMap);
			//END FORMATTING LAYER
			
			//SIDEBAR IMPLEMENTATION
			let sidebar = L.control.sidebar({
			autopan: false, 
			closeButton: true,
			container: "sidebar",
			position: "right"
			}).addTo(myMap);
			
			let info = "<h1>Tree Catalog- The Carbon Capture Institute of Trinidad & Tobago</h1>"
						+"<h2>Purpose:</h2>" + "<h2>Contributors:</h2>";
						
			let panelConent = {
				id: 'info',
				tab: '<img class ="sidebar-tab-icon" src="./logos/logo_color.png">',
				pane: info,
				title: 'Information',
				position: 'top'
			};
			sidebar.addPanel(panelConent);
			
			sidebar.addPanel({
				id: 'ghlink',
				tab: '<img class ="sidebar-tab-icon" src="./logos/github_logo.png">',
				button: 'https://github.com/aashritamohess/OnlineMapTraining',
				position: "bottom"
			});
			
			//close on mapclick behaviour
			myMap.on("click", function() {sidebar.close()});
			
			//fetching the data
			let treeData;
			
			fetch("./treesdata_wgs84.geojson")
				.then(response => {
				return response.json();
			})
			.then(data => {
				return treeData = data;
				})
			.then(data => treeLayer.addData(data));
			</script>
	</body>
</html>